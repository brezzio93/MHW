<!-- Mission Select -->
<dx-select-box
    [items]="missionList"
    valueExpr="id"
    fieldTemplate="field"
    label="Choose Quest"
    labelMode="floating"
    (onValueChanged)="selectQuest($event.value)"
    >
    <div *dxTemplate="let data of 'field'">
        <div class="custom-item">
            <img alt="" src="{{ data && data.icon }}" style="height: 50px" />
            <dx-text-box
                class="text"
                [value]="data && data.difficulty"
                [inputAttr]="{ 'aria-label': 'Name' }"
                [readOnly]="true"
            ></dx-text-box>
        </div>
    </div>
    <div *dxTemplate="let data of 'item'">
        <div class="custom-item">
            <img alt="" src="{{ data && data.icon }}" style="height: 50px" />
            <div class="text"> {{ data.difficulty }} </div>
        </div>
    </div>
</dx-select-box>

<!-- Quest -->
@if (!showTrackTokens) {
    <!-- Choose Starting Point -->
    @if(node == undefined) {
        @if(startingPoint.length != 0){
            <h4>Set Starting point</h4>
        }
        @for(i of startingPoint; track i) {
        <div class="questNode" style="border-width: 2px; border-color:#7f7f7f" (click)="selectStartingNode(i)">
            <div class="titleNode">
                <span> {{ i }} </span>
            </div>
            <div class="textNode">
                <span> {{ quest[i - 1].text }} </span>
                @if(quest[i - 1].action != undefined) {
                    <div style="text-align: center;">
                        <br>
                        <span style="white-space: pre-wrap;" [innerHTML]="quest[i - 1].action"> </span>
                    </div>
                }
            </div>
        
            <div>
                @for(option of quest[i-1].options; track option){
                    <div class="startingOptionNode">
                        {{option.text}}
                        <br>
                        <span style="white-space: pre-wrap;" [innerHTML]="option.action"> </span>
                        @if(option.progressTo != undefined) {
                            <span [innerHTML]="'<b>Avanzan a la entrada ' + option.progressTo +'</b>'"> </span>
                        }
                    </div>
                }
            </div>
        </div>
        }
    }
    
    <!-- Node -->
    @if(node != undefined){
        <div class="questNode">
            <div class="titleNode">
                <span> {{ node.id }} </span>
            </div>
    
            <div class="textNode">
                <span> {{ node.text }} </span>
                @if(node.action != undefined) {
                    <div>
                        <br>
                        <span> {{ node.action }} </span>
                    </div>
                }
            </div>
            
            <div>
                @for(option of node.options; track option) {
                    <div class="optionNode" [ngClass]="{'disabled':option.disabled?.disabled}" (click)="selectNode(option)">
                        {{option.text}}
                        <br>
                        <span style="white-space: pre-wrap;"> {{ option.action }} </span>
                        @if(option.progressTo != undefined) {
                            <span [innerHTML]="'<b>Avanzan a la entrada ' + option.progressTo +'</b>'"> </span>
                        }
                    </div>
                }
            </div>        
        </div>
    }
}
@if (showTrackTokens){
    <h2> Track Tokens: {{trackTokens}} </h2>
}
